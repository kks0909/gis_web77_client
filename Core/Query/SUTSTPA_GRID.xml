<?xml version="1.0" encoding="utf-8"?>
<root version="7.7.7.10" descr="СУ ТС ТПА">
  <data id="SUTSTPA_КРАН" comment="VALVE" schema="SUTSTPA" table="VALVE">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
                <query>
with sum_koef as (select n.check_table,sum(n.koeff) max_sum from sutstpa.sprav_ntd_gcl n where n.check_table is not null group by n.check_table),
koef as (select (select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_4_IS') k_BARRIER_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_1_IS') k_ORDER_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_4_IS') k_TERRITORY_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_1_IS') k_BARRIER_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_5_IS') k_ORDER_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_6_IS') k_ORDER_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='PLATE_IS') k_PLATE_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_7_IS') k_CONT_MEAS_7_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_2_IS') k_INF_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_3_IS') k_INF_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_5_IS') k_BARRIER_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_2_IS') k_SIGN_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_3_IS') k_SIGN_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_4_IS') k_SIGN_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_2_IS') k_ORDER_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_5_IS') k_SIGN_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_6_IS') k_SIGN_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_1_IS') k_TERRITORY_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_2_IS') k_TERRITORY_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_3_IS') k_TERRITORY_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_2_IS') k_BARRIER_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_3_IS') k_BARRIER_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_3_IS') k_ORDER_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_4_IS') k_order_4_is,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ROOF_IS') k_ROOF_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='HEIGHT_IS') k_HEIGHT_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_IS') k_COLOR_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_2_IS') k_CONT_MEAS_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_3_IS') k_CONT_MEAS_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_4_IS') k_CONT_MEAS_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_6_IS') k_CONT_MEAS_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_5_IS') k_CONT_MEAS_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='EXT_CORR_1_IS') k_EXT_CORR_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='EXT_CORR_2_IS') k_EXT_CORR_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='EXT_CORR_3_IS') k_EXT_CORR_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_1_IS') k_GROUND_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_2_IS') k_GROUND_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_3_IS') k_GROUND_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_4_IS') k_GROUND_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_5_IS') k_GROUND_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_3_IS') k_COLOR_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_1_IS') k_COLOR_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_2_IS') k_COLOR_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_4_IS') k_COLOR_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_5_IS') k_COLOR_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_6_IS') k_COLOR_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_1_IS') k_INF_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_4_IS') k_INF_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_5_IS') k_INF_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_6_IS') k_INF_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_NOM_DIAM_IS') k_INF_NOM_DIAM_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_PRES_IS') k_INF_PRES_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_DATE_MANUF_IS') k_INF_DATE_MANUF_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_MANUF_IS') k_INF_MANUF_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TECH_NUM_IS') k_TECH_NUM_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='VERT_IS') k_VERT_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_1') k_ADD_IS_1,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_2') k_ADD_IS_2,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_3') k_ADD_IS_3,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_4') k_ADD_IS_4,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='PEDESTAL_IS') k_PEDESTAL_IS),
valve as (select 
lpu||', '||les||', '||pipe||', '||round(station,1)||' км.' "LABEL", 
id, lpu, les, pipe, station, type_id, oper_type_id, name_id, tech_num, tech_num_is, joint_id, plate_is, nom_diam_id, nom_press_id, descr, serial_num, manuf_id, ext_corr_1_is, ext_corr_2_is, ext_corr_3_is, ground_1_is, 
ground_2_is, ground_3_is, ground_4_is, ground_5_is, color_1_is, color_2_is, color_3_is, color_4_is, color_5_is, color_6_is, inf_1_is, inf_2_is, inf_3_is, inf_4_is, inf_5_is, operator1, operator2, operator3, 
to_char(date_to1,'DD.MM.YYYY') date_to1, result_to1,to_char(date_to2,'DD.MM.YYYY')  date_to2, result_to2,to_char(date_tr,'DD.MM.YYYY')  date_tr, result_tr,to_char(date_sr,'DD.MM.YYYY')  date_sr, result_sr, operator4, operator5, operator6, 
to_char(date_insp,'DD.MM.YYYY') date_insp, to_char(date_manuf,'DD.MM.YYYY') date_manuf, struct_id, inf_6_is, material_id, install_type_id, func_type_id, execution_type_id, electric_drive_descr, 
electric_drive_ready_descr, tpa_figure_type_id, tpa_constr_type_id, to_char(date_install,'DD.MM.YYYY')  date_install, to_char(date_work_begin,'DD.MM.YYYY') date_work_begin, climatic_type_id, invent_number, lifetime, 
to_char(date_exp,'DD.MM.YYYY') date_exp,to_char(date_epb1_plan,'DD.MM.YYYY')  date_epb1_plan,to_char(date_epb1_fact,'DD.MM.YYYY')  date_epb1_fact, result_epb1,to_char(date_epb2_plan,'DD.MM.YYYY')  date_epb2_plan, 
to_char(date_epb2_fact,'DD.MM.YYYY') date_epb2_fact, result_epb2, to_char(date_epb_next_plan,'DD.MM.YYYY') date_epb_next_plan,to_char(date_epb_next_fact,'DD.MM.YYYY')  date_epb_next_fact, result_epb_next, lubricant_value, 
hydrofluid_value, passport_document_descr, work_pressure_fact, work_temp_project, work_temp_fact, to_char(date_repair,'DD.MM.YYYY') date_repair, serial_number_repair, repair_descr, to_char(date_dtoir_plan,'DD.MM.YYYY') date_dtoir_plan, 
to_char(date_dtoir_fact,'DD.MM.YYYY') date_dtoir_fact, seal_past_cons_plan, seal_past_cons_fact, hydrofluid_cons_plan, hydrofluid_cons_fact, seal_past_cons_plan_year, seal_past_cons_plan_fact, hydrofluid_cons_plan_year, 
hydrofluid_cons_fact_year, leak_descr, to_char(date_leak_detect,'DD.MM.YYYY') date_leak_detect, to_char(date_leak_fix,'DD.MM.YYYY') date_leak_fix, shutter_tight_descr, to_char(date_untight_detect,'DD.MM.YYYY') date_untight_detect, 
to_char(date_untight_fix,'DD.MM.YYYY') date_untight_fix, oper_manuf_id, to_char(oper_date_manuf,'DD.MM.YYYY') oper_date_manuf, oper_label_type_id, oper_serial_number, to_char(oper_date_work_begin,'DD.MM.YYYY') oper_date_work_begin, 
order_6_is,   cont_meas_2_is, cont_meas_3_is, cont_meas_4_is, cont_meas_5_is, cont_meas_6_is, cont_meas_7_is, infoteh_is, infoteh_correction, infoteh_col_cor_list, infoteh_comment, to_char(date_to_lubricant_plan,'DD.MM.YYYY') date_to_lubricant_plan, 
to_char(date_to_lubricant_fact,'DD.MM.YYYY') date_to_lubricant_fact, to_char(date_rso,'DD.MM.YYYY') date_rso,  add_is_1, add_is_2, add_is_3, add_is_4,
coalesce(ext_corr_1_is,0)*k_ext_corr_1_is+coalesce(ext_corr_2_is,0)*k_ext_corr_2_is+coalesce(ext_corr_3_is,0)*k_ext_corr_3_is+coalesce(ground_1_is,0)*k_ground_1_is+coalesce(ground_2_is,0)*k_ground_2_is+coalesce(ground_3_is,0)*k_ground_3_is
+coalesce(ground_4_is,0)*k_ground_4_is+coalesce(ground_5_is,0)*k_ground_5_is+abs(1-coalesce(color_1_is,1))*k_color_1_is+abs(1-coalesce(color_2_is,1))*k_color_2_is+abs(1-coalesce(color_3_is,1))*k_color_3_is
+abs(1-coalesce(color_4_is,1))*k_color_4_is+abs(1-coalesce(color_5_is,1))*k_color_5_is+abs(1-coalesce(color_6_is,1))*k_color_6_is+abs(1-coalesce(inf_1_is,1))*k_inf_1_is+abs(1-coalesce(inf_2_is,1))*k_inf_2_is
+abs(1-coalesce(inf_3_is,1))*k_inf_3_is+abs(1-coalesce(inf_4_is,1))*k_inf_4_is+abs(1-coalesce(inf_5_is,1))*k_inf_5_is+(cASE WHEN v.date_manuf is null THEN 1 else 0 end)*k_INF_DATE_MANUF_IS
+(cASE WHEN v.manuf_id is null THEN 1 else 0 end)*k_INF_MANUF_IS +coalesce(order_6_is,0)*k_order_6_is+abs(1-coalesce(cont_meas_2_is,1))*k_cont_meas_2_is+abs(1-coalesce(cont_meas_3_is,1))*k_cont_meas_3_is
+abs(1-coalesce(cont_meas_4_is,1))*k_cont_meas_4_is+abs(1-coalesce(cont_meas_5_is,1))*k_cont_meas_5_is+abs(1-coalesce(cont_meas_6_is,1))*k_cont_meas_6_is+abs(1-coalesce(cont_meas_7_is,1))*k_cont_meas_7_is
+coalesce(add_is_1,0)*k_add_is_1+coalesce(add_is_2,0)*k_add_is_2+coalesce(add_is_3,0)*k_add_is_3+coalesce(add_is_4,0)*k_add_is_4 rank
 from sutstpa.valve v,koef k)
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,"LABEL", 
		   CASE when rank&lt;=sum_k.max_sum*0.15 then 'GREEN' 
           		when rank&gt;sum_k.max_sum*0.15 and rank&lt;=sum_k.max_sum*0.5 then 'YELLOW'
		 	when rank&gt;sum_k.max_sum*0.5 then 'RED' 
		   end "TYPE",
 id, id valve_id,lpu, les, pipe, station, type_id, oper_type_id, name_id, tech_num, tech_num_is, joint_id, plate_is, nom_diam_id, nom_press_id, descr, serial_num, manuf_id, ext_corr_1_is, ext_corr_2_is, ext_corr_3_is, ground_1_is, 
ground_2_is, ground_3_is, ground_4_is, ground_5_is, color_1_is, color_2_is, color_3_is, color_4_is, color_5_is, color_6_is, inf_1_is, inf_2_is, inf_3_is, inf_4_is, inf_5_is, operator1, operator2, operator3, 
date_to1, result_to1, date_to2, result_to2, date_tr, result_tr, date_sr, result_sr, operator4, operator5, operator6, date_insp, date_manuf, struct_id, inf_6_is, material_id, install_type_id, func_type_id, 
execution_type_id, electric_drive_descr, electric_drive_ready_descr, tpa_figure_type_id, tpa_constr_type_id, date_install, date_work_begin, climatic_type_id, invent_number, lifetime, 
date_exp, date_epb1_plan, date_epb1_fact, result_epb1, date_epb2_plan, date_epb2_fact, result_epb2, date_epb_next_plan, date_epb_next_fact, result_epb_next, lubricant_value, hydrofluid_value, passport_document_descr, 
work_pressure_fact, work_temp_project, work_temp_fact, date_repair, serial_number_repair, repair_descr, date_dtoir_plan, date_dtoir_fact, seal_past_cons_plan, seal_past_cons_fact, hydrofluid_cons_plan, hydrofluid_cons_fact, 
seal_past_cons_plan_year, seal_past_cons_plan_fact, hydrofluid_cons_plan_year, hydrofluid_cons_fact_year, leak_descr, date_leak_detect, date_leak_fix, shutter_tight_descr, date_untight_detect, date_untight_fix, oper_manuf_id, 
oper_date_manuf, oper_label_type_id, oper_serial_number, oper_date_work_begin, order_6_is, cont_meas_2_is, cont_meas_3_is, cont_meas_4_is, cont_meas_5_is, cont_meas_6_is, cont_meas_7_is, 
infoteh_is, infoteh_correction, infoteh_col_cor_list, infoteh_comment, date_to_lubricant_plan, date_to_lubricant_fact, date_rso, add_is_1, add_is_2, add_is_3, add_is_4, rank
					FROM valve, sum_koef sum_k where sum_k.check_table='sutstpa.valve' and {FILTER}) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
                </query>
            </dbQuery>
        </select>
  </data>
  <data id="SUTSTPA_СВЕЧА" comment="VENT_PIPE" schema="SUTSTPA" table="VENT_PIPE">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <query>
with sum_koef as (select n.check_table,sum(n.koeff) max_sum from sutstpa.sprav_ntd_gcl n where n.check_table is not null group by n.check_table),
koef as (select (select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_4_IS') k_BARRIER_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_1_IS') k_ORDER_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_4_IS') k_TERRITORY_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_1_IS') k_BARRIER_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_5_IS') k_ORDER_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_6_IS') k_ORDER_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='PLATE_IS') k_PLATE_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_7_IS') k_CONT_MEAS_7_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_2_IS') k_INF_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_3_IS') k_INF_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_5_IS') k_BARRIER_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_2_IS') k_SIGN_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_3_IS') k_SIGN_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_4_IS') k_SIGN_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_2_IS') k_ORDER_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_5_IS') k_SIGN_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_6_IS') k_SIGN_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_1_IS') k_TERRITORY_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_2_IS') k_TERRITORY_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_3_IS') k_TERRITORY_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_2_IS') k_BARRIER_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_3_IS') k_BARRIER_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_3_IS') k_ORDER_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_4_IS') k_order_4_is,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ROOF_IS') k_ROOF_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='HEIGHT_IS') k_HEIGHT_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_IS') k_COLOR_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_2_IS') k_CONT_MEAS_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_3_IS') k_CONT_MEAS_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_4_IS') k_CONT_MEAS_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_6_IS') k_CONT_MEAS_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_5_IS') k_CONT_MEAS_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='EXT_CORR_1_IS') k_EXT_CORR_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='EXT_CORR_2_IS') k_EXT_CORR_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='EXT_CORR_3_IS') k_EXT_CORR_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_1_IS') k_GROUND_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_2_IS') k_GROUND_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_3_IS') k_GROUND_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_4_IS') k_GROUND_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_5_IS') k_GROUND_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_3_IS') k_COLOR_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_1_IS') k_COLOR_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_2_IS') k_COLOR_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_4_IS') k_COLOR_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_5_IS') k_COLOR_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_6_IS') k_COLOR_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_1_IS') k_INF_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_4_IS') k_INF_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_5_IS') k_INF_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_6_IS') k_INF_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_NOM_DIAM_IS') k_INF_NOM_DIAM_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_PRES_IS') k_INF_PRES_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_DATE_MANUF_IS') k_INF_DATE_MANUF_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_MANUF_IS') k_INF_MANUF_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TECH_NUM_IS') k_TECH_NUM_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='VERT_IS') k_VERT_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_1') k_ADD_IS_1,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_2') k_ADD_IS_2,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_3') k_ADD_IS_3,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_4') k_ADD_IS_4,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='PEDESTAL_IS') k_PEDESTAL_IS),
vent_pipe as (SELECT 
lpu||', '||les||', '||pipe||', '||round(station,1)||' км.' "LABEL", 
id, lpu, les, pipe, station,to_char(date_insp,'DD.MM.YYYY') date_insp, height_is, color_is, roof_is, pedestal_is, vert_is, lg_attach, operator1, operator2, operator3,operator4,operator5,operator6,struct_id,
abs(1-coalesce(height_is,1))*k_height_is+abs(1-coalesce(color_is,1))*k_color_is+abs(1-coalesce(roof_is,1))*k_roof_is+abs(1-coalesce(pedestal_is,1))*k_pedestal_is+abs(1-coalesce(vert_is,1))*k_vert_is rank
FROM sutstpa.vent_pipe,koef k)
	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS}) RWN,id,"LABEL",lpu,les,pipe,station,date_insp,height_is,color_is,roof_is,pedestal_is, vert_is, operator1,operator2,operator3,operator4,operator5,operator6, rank,struct_id,
		   CASE when rank&lt;=sum_k.max_sum*0.15 then 'GREEN' 
           		when rank&gt;sum_k.max_sum*0.15 and rank&lt;=sum_k.max_sum*0.5 then 'YELLOW'
		 	when rank&gt;sum_k.max_sum*0.5 then 'RED'  
					end "TYPE"   
FROM vent_pipe, sum_koef sum_k where sum_k.check_table='sutstpa.vent_pipe' and {FILTER}) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
      </query>
     </dbQuery>
    </select>
  </data>
  <data id="SUTSTPA_КРАНОВЫЙ_УЗЕЛ" comment="STRUCTURE" schema="SUTSTPA" table="STRUCTURE">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
with sum_koef as (select n.check_table,sum(n.koeff) max_sum from sutstpa.sprav_ntd_gcl n where n.check_table is not null group by n.check_table),
koef as (select (select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_4_IS') k_BARRIER_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_1_IS') k_ORDER_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_4_IS') k_TERRITORY_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_1_IS') k_BARRIER_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_5_IS') k_ORDER_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_6_IS') k_ORDER_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='PLATE_IS') k_PLATE_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_7_IS') k_CONT_MEAS_7_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_2_IS') k_INF_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_3_IS') k_INF_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_5_IS') k_BARRIER_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_2_IS') k_SIGN_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_3_IS') k_SIGN_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_4_IS') k_SIGN_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_2_IS') k_ORDER_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_5_IS') k_SIGN_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='SIGN_6_IS') k_SIGN_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_1_IS') k_TERRITORY_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_2_IS') k_TERRITORY_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TERRITORY_3_IS') k_TERRITORY_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_2_IS') k_BARRIER_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='BARRIER_3_IS') k_BARRIER_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_3_IS') k_ORDER_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ORDER_4_IS') k_order_4_is,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ROOF_IS') k_ROOF_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='HEIGHT_IS') k_HEIGHT_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_IS') k_COLOR_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_2_IS') k_CONT_MEAS_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_3_IS') k_CONT_MEAS_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_4_IS') k_CONT_MEAS_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_6_IS') k_CONT_MEAS_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='CONT_MEAS_5_IS') k_CONT_MEAS_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='EXT_CORR_1_IS') k_EXT_CORR_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='EXT_CORR_2_IS') k_EXT_CORR_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='EXT_CORR_3_IS') k_EXT_CORR_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_1_IS') k_GROUND_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_2_IS') k_GROUND_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_3_IS') k_GROUND_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_4_IS') k_GROUND_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='GROUND_5_IS') k_GROUND_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_3_IS') k_COLOR_3_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_1_IS') k_COLOR_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_2_IS') k_COLOR_2_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_4_IS') k_COLOR_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_5_IS') k_COLOR_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='COLOR_6_IS') k_COLOR_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_1_IS') k_INF_1_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_4_IS') k_INF_4_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_5_IS') k_INF_5_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_6_IS') k_INF_6_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_NOM_DIAM_IS') k_INF_NOM_DIAM_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_PRES_IS') k_INF_PRES_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_DATE_MANUF_IS') k_INF_DATE_MANUF_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='INF_MANUF_IS') k_INF_MANUF_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='TECH_NUM_IS') k_TECH_NUM_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='VERT_IS') k_VERT_IS,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_1') k_ADD_IS_1,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_2') k_ADD_IS_2,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_3') k_ADD_IS_3,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='ADD_IS_4') k_ADD_IS_4,
(select k.koeff from sutstpa.sprav_ntd_gcl k where k.check_column='PEDESTAL_IS') k_PEDESTAL_IS),
structure as (select lpu||', '||les||', '||pipe||', '||round(station,1)||' км.' "LABEL", id,lpu,les,pipe,station,date_insp,sign_2_is,sign_3_is,sign_4_is,sign_5_is,sign_6_is,territory_1_is,territory_2_is,
territory_3_is,territory_4_is,barrier_1_is,barrier_2_is,barrier_3_is,barrier_4_is,barrier_5_is,order_1_is,order_2_is,order_3_is,order_4_is,order_5_is,cont_meas_8_is,operator1,operator2,operator3,operator4,operator5,
operator6,date_rso_plan,date_rso_fact,add_pet_is_1, add_pet_is_2, add_pet_is_3, add_pet_is_4, corr_id,
abs(1-coalesce(sign_2_is,1))*k_sign_2_is+abs(1-coalesce(sign_3_is,1))*k_sign_3_is+abs(1-coalesce(sign_4_is,1))*k_sign_4_is+abs(1-coalesce(sign_5_is,1))*k_sign_5_is+abs(1-coalesce(sign_6_is,1))*k_sign_6_is
+coalesce(territory_1_is,0)*k_territory_1_is+coalesce(territory_2_is,0)*k_territory_2_is+coalesce(territory_3_is,0)*k_territory_3_is+coalesce(territory_4_is,0)*k_territory_4_is+abs(1-coalesce(barrier_1_is,1))*k_barrier_1_is
+abs(1-coalesce(barrier_2_is,1))*k_barrier_2_is+abs(1-coalesce(barrier_3_is,1))*k_barrier_3_is+abs(1-coalesce(barrier_4_is,1))*k_barrier_4_is+abs(1-coalesce(barrier_5_is,1))*k_barrier_5_is+coalesce(order_1_is,0)*k_order_1_is
+coalesce(order_2_is,0)*k_order_2_is+coalesce(order_3_is,0)*k_order_3_is+coalesce(order_4_is,0)*k_order_4_is+coalesce(order_5_is,0)*k_order_5_is rank
from sutstpa.structure s,koef k)
         SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,id,"LABEL",lpu,les,pipe,station,date_insp,sign_2_is,sign_3_is,sign_4_is,sign_5_is,sign_6_is,territory_1_is,territory_2_is,territory_3_is,
territory_4_is,barrier_1_is,barrier_2_is,barrier_3_is, barrier_4_is,barrier_5_is,order_1_is,order_2_is,order_3_is,order_4_is,order_5_is,cont_meas_8_is,operator1,operator2,operator3,operator4,operator5,operator6,rank,date_rso_plan,date_rso_fact,
add_pet_is_1, add_pet_is_2, add_pet_is_3, add_pet_is_4, corr_id,
		   CASE when rank&lt;=sum_k.max_sum*0.15 then 'GREEN' 
           		when rank&gt;sum_k.max_sum*0.15 and rank&lt;=sum_k.max_sum*0.5 then 'YELLOW'
		 	when rank&gt;sum_k.max_sum*0.5 then 'RED'  
					end "TYPE" 
		   FROM structure, sum_koef sum_k where sum_k.check_table='sutstpa.structure' and {FILTER}) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
		  </query>
            </dbQuery>
        </select>
  </data>
  <data id="SUTSTPA_SERVICE_MAINTENANCE" comment="SERVICE_MAINTENANCE" schema="SUTSTPA" table="SERVICE_MAINTENANCE">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <query>
	   	 with valve as (     select v.id valve_id, spl.description||', '||spp.description||', '||round(v.station,1)||' км, Dn='||v.nom_diam_id||', '||SPN.description description from sutstpa.valve v,
     sutstpa.sprav_lpu_gcl spl, sutstpa.sprav_pipe_gcl spp, sutstpa.sprav_valve_tpa_name_gcl spn where v.lpu=spl.code and v.pipe=spp.code and spn.code=v.name_id and {FILTER})
     SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN 
  ,all_in_one.ID,all_in_one.valve_id, all_in_one.date_plan, all_in_one.date_fact, all_in_one.type_cl, all_in_one.result, all_in_one.description, 
   all_in_one.lubricant_value_fact, all_in_one.hydrofluid_value_fact, all_in_one.person_id, all_in_one.notif_id,
    all_in_one.valve_lbl, all_in_one.type_lbl, all_in_one.person_lbl,	all_in_one.message_lbl,all_in_one.result_1_cl, all_in_one.result_2_cl, all_in_one.correction_cl, all_in_one.result_1_cl_lbl, all_in_one.result_2_cl_lbl, all_in_one.correction_cl_lbl
  FROM (
 SELECT v.maint_id ID, v.valve_id, v.date_plan, v.date_fact, v.type_cl, v.result, v.description, v.lubricant_value_fact, v.hydrofluid_value_fact, v.person_id, v.notif_id, vv.description valve_lbl, vv.description "LABEL", gcr.description type_lbl, p.position||', '||p.name||' '||p.last_name person_lbl,
	m.description message_lbl, v.result_1_cl, v.result_2_cl, v.correction_cl, m1.description result_1_cl_lbl, m2.description result_2_cl_lbl, c.description correction_cl_lbl
			FROM sutstpa.service_maintenance v left join sutstpa.notif_message m on m.message_id=v.notif_id
							   left join sutstpa.notif_person p on p.person_id=v.person_id
							   left join sutstpa.sprav_service_maint_1_result_gcl m1 on m1.code=v.result_1_cl
							   left join sutstpa.sprav_service_maint_2_result_gcl m2 on m2.code=v.result_2_cl 
							   left join sutstpa.sprav_service_maint_correction_gcl c on c.code=v.correction_cl
							   , valve vv, sutstpa.sprav_service_maint_gcl gcr
			where vv.valve_id=v.valve_id and gcr.code=v.type_cl
     ) all_in_one) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
      </query>
     </dbQuery>
    </select>
  </data>
  <data id="SUTSTPA_SERVICE_EPB" comment="SERVICE_EPB" schema="SUTSTPA" table="SERVICE_EPB">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <query>
	   	 with valve as (     select v.id valve_id, spl.description||', '||spp.description||', '||round(v.station,1)||' км, Dn='||v.nom_diam_id||', '||SPN.description description from sutstpa.valve v,
     sutstpa.sprav_lpu_gcl spl, sutstpa.sprav_pipe_gcl spp, sutstpa.sprav_valve_tpa_name_gcl spn where v.lpu=spl.code and v.pipe=spp.code and spn.code=v.name_id and {FILTER})
	        SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN 
  ,all_in_one.ID,all_in_one.valve_id, all_in_one.date_plan, all_in_one.date_fact, all_in_one.type_cl, all_in_one.result, all_in_one.description, all_in_one.person_id, all_in_one.notif_id,
    all_in_one.valve_lbl, all_in_one.type_lbl, all_in_one.person_lbl,	all_in_one.message_lbl
  FROM (
 SELECT v.epb_id ID, v.valve_id, v.date_plan, v.date_fact, v.type_cl, v.result, v.description, v.person_id, v.notif_id, vv.description valve_lbl, vv.description "LABEL", gcr.description type_lbl, p.position||', '||p.name||' '||p.last_name person_lbl,
	m.description message_lbl
			FROM sutstpa.service_epb v left join sutstpa.notif_message m on m.message_id=v.notif_id
						   left join sutstpa.notif_person p on p.person_id=v.person_id,  valve vv, sutstpa.sprav_service_epb_gcl gcr
			where vv.valve_id=v.valve_id and gcr.code=v.type_cl
     ) all_in_one) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
        </query>
     </dbQuery>
    </select>
  </data>
  <data id="SUTSTPA_SERVICE_COND_VIOL" comment="SERVICE_COND_VIOL" schema="SUTSTPA" table="SERVICE_COND_VIOL">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <query>
	 with valve as (     select v.id valve_id, spl.description||', '||spp.description||', '||round(v.station,1)||' км, Dn='||v.nom_diam_id||', '||SPN.description description from sutstpa.valve v,
     sutstpa.sprav_lpu_gcl spl, sutstpa.sprav_pipe_gcl spp, sutstpa.sprav_valve_tpa_name_gcl spn where v.lpu=spl.code and v.pipe=spp.code and spn.code=v.name_id and {FILTER})
	        SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN 
  ,all_in_one.ID,all_in_one.valve_id, all_in_one.date_detect, all_in_one.date_fix, all_in_one.type_cl, all_in_one.result, all_in_one.description, all_in_one.person_id, all_in_one.notif_id,
    all_in_one.valve_lbl, all_in_one.type_lbl, all_in_one.person_lbl,	all_in_one.message_lbl
  FROM (
 	SELECT v.cond_viol_id ID, v.valve_id, v.date_detect, v.date_fix, v.type_cl, v.result, v.description, v.person_id, v.notif_id, vv.description valve_lbl, vv.description "LABEL", gcr.description type_lbl, p.position||', '||p.name||' '||p.last_name person_lbl,
	m.description message_lbl
			FROM sutstpa.service_cond_viol v left join sutstpa.notif_message m on m.message_id=v.notif_id
							 left join sutstpa.notif_person p on p.person_id=v.person_id, valve vv, sutstpa.sprav_service_cond_viol_gcl gcr
			where vv.valve_id=v.valve_id and gcr.code=v.type_cl
     ) all_in_one) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
      </query>
     </dbQuery>
    </select>
  </data>
  <data id="SUTSTPA_SERVICE_REPAIR" comment="SERVICE_REPAIR" schema="SUTSTPA" table="SERVICE_REPAIR">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <query>
	   	   with valve as (     select v.id valve_id, spl.description||', '||spp.description||', '||round(v.station,1)||' км, Dn='||v.nom_diam_id||', '||SPN.description description from sutstpa.valve v,
     sutstpa.sprav_lpu_gcl spl, sutstpa.sprav_pipe_gcl spp, sutstpa.sprav_valve_tpa_name_gcl spn where v.lpu=spl.code and v.pipe=spp.code and spn.code=v.name_id and {FILTER})
	        SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN 
  ,all_in_one.ID,all_in_one.valve_id, all_in_one.date_plan, all_in_one.date_fact, all_in_one.type_cl, all_in_one.result, all_in_one.description, all_in_one.serial_number_repair, all_in_one.person_id, all_in_one.notif_id,
  all_in_one.valve_lbl, all_in_one.type_lbl, all_in_one.person_lbl,	all_in_one.message_lbl
  FROM (
 	SELECT r.repair_id ID, r.valve_id, r.date_plan, r.date_fact, r.type_cl, r.result, r.description, r.serial_number_repair, r.person_id, r.notif_id, vv.description valve_lbl, vv.description "LABEL", gcr.description type_lbl, p.position||', '||p.name||' '||p.last_name person_lbl,
	m.description message_lbl
			FROM sutstpa.service_repair r left join sutstpa.notif_message m on m.message_id=r.notif_id
						      left join sutstpa.notif_person p on p.person_id=r.person_id, valve vv, sutstpa.sprav_service_repair_gcl gcr
			where vv.valve_id=r.valve_id and gcr.code=r.type_cl
     ) all_in_one) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
      </query>
     </dbQuery>
    </select>
  </data>
  <data id="SUTSTPA_MISMATCH_EXEC_DOC_FORMAT" comment="MISMATCH_EXEC_DOC_FORMAT" schema="SUTSTPA" table="MISMATCH_EXEC_DOC_FORMAT">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <query>
	   with valve as (     select v.id valve_id, spl.description||', '||spp.description||', '||round(v.station,1)||' км, Dn='||v.nom_diam_id||', '||SPN.description description from sutstpa.valve v,
     sutstpa.sprav_lpu_gcl spl, sutstpa.sprav_pipe_gcl spp, sutstpa.sprav_valve_tpa_name_gcl spn where v.lpu=spl.code and v.pipe=spp.code and spn.code=v.name_id and {FILTER})
	        SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN 
  ,all_in_one.ID,all_in_one.valve_id, all_in_one.description, all_in_one.valve_lbl
  FROM (
	SELECT vv.valve_id ID,vv.valve_id, f.description, vv.description valve_lbl, vv.description "LABEL"
			FROM sutstpa.mismatch_exec_doc_format f,valve vv where vv.valve_id=f.valve_id
     ) all_in_one) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
      </query>
     </dbQuery>
    </select>
  </data>
  <data id="SUTSTPA_MISMATCH_EXEC_DOC" comment="MISMATCH_EXEC_DOC" schema="SUTSTPA" table="MISMATCH_EXEC_DOC">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <var name="ID" type="Decimal" default="select id from sutstpa.valve"/>
       <query>
	   with doc_file as (select v.file_name from web50.lib_doc d,web50.lib_doc_version v,web50.lnk_gate g where g.left_obj_id='WEB50_LIB_DOC/'||d.doc_id and  d.doc_id=v.doc_id and g.right_obj_id='SUTSTPA_КРАН/'||(select id from sutstpa.valve where {FILTER}) and d.parent_doc_id=160600 limit 1),
sprav_col as (select 'CLIMATIC_TYPE_ID' col_name, 'Климатическое исполнение крана' col_descr union all
select 'DATE_INSTALL' col_name, 'Дата врезки' col_descr union all
select 'DATE_MANUF' col_name, 'Дата изготовления' col_descr union all
select 'ELECTRIC_DRIVE_DESCR' col_name, 'Готовность крана к телемеханизации' col_descr union all
select 'DATE_WORK_BEGIN' col_name, 'Дата ввода в эксплуатацию ТПА' col_descr union all
select 'INSTALL_TYPE_ID' col_name, 'Тип  установки' col_descr union all
select 'INVENT_NUMBER' col_name, 'Инв. номер ТПА' col_descr union all
select 'JOINT_ID' col_name, 'Тип присоединения' col_descr union all
select 'LIFETIME' col_name, 'Нормативный срок службы' col_descr union all
select 'MANUF_ID' col_name, 'Изготовитель ТПА' col_descr union all
select 'NAME_ID' col_name, 'Наименование ТПА' col_descr union all
select 'NOM_DIAM_ID' col_name, 'Номинальный диаметр DN' col_descr union all
select 'NOM_PRESS_ID' col_name, 'Номинальное давление PN' col_descr union all
select 'OPER_DATE_WORK_BEGIN' col_name, 'Год ввода в эксплуатацию привода' col_descr union all
select 'OPER_LABEL_TYPE_ID' col_name, 'Маркировка привода' col_descr union all
select 'OPER_MANUF_ID' col_name, 'Изготовитель привода' col_descr union all
select 'PASSPORT_DOCUMENT_DESCR' col_name, 'Наличие паспорта крана' col_descr union all
select 'SERIAL_NUM' col_name, 'Заводской номер' col_descr union all
select 'TECH_NUM' col_name, 'Технологический номер' col_descr union all
select 'WORK_PRESSURE_FACT' col_name, 'Фактическое рабочее давление' col_descr union all
select 'WORK_TEMP_FACT' col_name, 'Фактическая рабочая температура' col_descr union all
select 'WORK_TEMP_PROJECT' col_name, 'Проектная  рабочая температура' col_descr union all
select 'TYPE_ID' col_name, 'Тип крана' col_descr union all
select 'OPER_TYPE_ID' col_name, 'Тип привода' col_descr union all
select 'MATERIAL_ID' col_name, 'Материал изготовления корпуса' col_descr union all
select 'TPA_FIGURE_TYPE_ID' col_name, 'Маркировка ТПА по табл. фигур' col_descr union all
select 'TPA_CONSTR_TYPE_ID' col_name, 'Маркировка ТПА(по конструкт. докум.)' col_descr union all
select 'OPER_DATE_MANUF' col_name, 'Дата изготовления привода' col_descr union all
select 'OPER_SERIAL_NUMBER' col_name, 'Заводской номер привода' col_descr union all
select 'DESCR' col_name, 'Маркировка' col_descr union all
select 'DATE_EXP' col_name, 'Дата\nистеч.срока\nэксплуатации' col_descr),
valve_data as (select 'CLIMATIC_TYPE_ID' col_name, CLIMATIC_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'DATE_INSTALL' col_name, to_char(DATE_INSTALL,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER} union all
select 'DATE_MANUF' col_name,    to_char(DATE_MANUF,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER} union all
select 'ELECTRIC_DRIVE_DESCR' col_name, ELECTRIC_DRIVE_DESCR::text col_descr from sutstpa.valve v where {FILTER} union all
select 'DATE_WORK_BEGIN' col_name, to_char(DATE_WORK_BEGIN,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER} union all
select 'INSTALL_TYPE_ID' col_name, INSTALL_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'INVENT_NUMBER' col_name, INVENT_NUMBER::text col_descr from sutstpa.valve v where {FILTER} union all
select 'JOINT_ID' col_name, JOINT_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'LIFETIME' col_name, LIFETIME::text col_descr from sutstpa.valve v where {FILTER} union all
select 'MANUF_ID' col_name, MANUF_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'NAME_ID' col_name, NAME_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'NOM_DIAM_ID' col_name, NOM_DIAM_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'NOM_PRESS_ID' col_name, NOM_PRESS_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_DATE_WORK_BEGIN' col_name, to_char(OPER_DATE_WORK_BEGIN,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_LABEL_TYPE_ID' col_name, OPER_LABEL_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_MANUF_ID' col_name, OPER_MANUF_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'PASSPORT_DOCUMENT_DESCR' col_name, PASSPORT_DOCUMENT_DESCR::text col_descr from sutstpa.valve v where {FILTER} union all
select 'SERIAL_NUM' col_name, SERIAL_NUM::text col_descr from sutstpa.valve v where {FILTER} union all
select 'TECH_NUM' col_name, TECH_NUM::text col_descr from sutstpa.valve v where {FILTER} union all
select 'WORK_PRESSURE_FACT' col_name, WORK_PRESSURE_FACT::text col_descr from sutstpa.valve v where {FILTER} union all
select 'WORK_TEMP_FACT' col_name, WORK_TEMP_FACT::text col_descr from sutstpa.valve v where {FILTER} union all
select 'WORK_TEMP_PROJECT' col_name, WORK_TEMP_PROJECT::text col_descr from sutstpa.valve v where {FILTER} union all
select 'TYPE_ID' col_name, TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_TYPE_ID' col_name, OPER_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'MATERIAL_ID' col_name, MATERIAL_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'TPA_FIGURE_TYPE_ID' col_name, TPA_FIGURE_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'TPA_CONSTR_TYPE_ID' col_name, TPA_CONSTR_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_DATE_MANUF' col_name, to_char(OPER_DATE_MANUF,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_SERIAL_NUMBER' col_name, OPER_SERIAL_NUMBER::text col_descr from sutstpa.valve v where {FILTER} union all
select 'DESCR' col_name, DESCR::text col_descr from sutstpa.valve v where {FILTER} union all
select 'DATE_EXP' col_name, to_char(DATE_EXP,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER}),
valve as (     select v.id valve_id, spl.description||', '||spp.description||', '||round(v.station,1)||' км, Dn='||v.nom_diam_id||', '||SPN.description description from sutstpa.valve v,
     sutstpa.sprav_lpu_gcl spl, sutstpa.sprav_pipe_gcl spp, sutstpa.sprav_valve_tpa_name_gcl spn where v.lpu=spl.code and v.pipe=spp.code and spn.code=v.name_id  and {FILTER})
 SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN,
all_in_one.ID,
all_in_one.valve_id, 
all_in_one.column_name, 
all_in_one.column_value, 
all_in_one.col_descr, 
all_in_one.action_id, 
all_in_one.person_id, 
all_in_one.file_name,
	   all_in_one.action_lbl, all_in_one.valve_lbl, all_in_one.person_lbl
  from 
(select m.mismatch_id id /*Идентификатор - по умолчанию скрыт*/, m.valve_id, col.col_descr column_name/*Название характеристики*/,m.column_value /*неверное начение*/, v.col_descr, /*верное значение*/
m.action_id /*Что делать*/,m.person_id/*Ответственный*/,dd.file_name, spa.description action_lbl, vv.description valve_lbl, vv.description "LABEL", p.position||', '||p.name||' '||p.last_name person_lbl  from sprav_col col, valve_data v,sutstpa.mismatch_exec_doc m, sutstpa.sprav_service_action_gcl spa, sutstpa.notif_person p,valve vv
left join doc_file dd on 1=1
                    where  v.col_name=m.column_name and col.col_name=m.column_name and spa.code=m.action_id and vv.valve_id=m.valve_id and p.person_id=m.person_id
     ) all_in_one) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
      </query>
     </dbQuery>
    </select>
  </data>
  <data id="SUTSTPA_MISMATCH_INFOTEH" comment="MISMATCH_INFOTEH" schema="SUTSTPA" table="MISMATCH_INFOTEH">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <var name="ID" type="Decimal" default="select id from sutstpa.valve"/>
       <query>
	   with sprav_col as (select 'CLIMATIC_TYPE_ID' col_name, 'Климатическое исполнение крана' col_descr union all
select 'DATE_INSTALL' col_name, 'Дата врезки' col_descr union all
select 'DATE_MANUF' col_name, 'Дата изготовления' col_descr union all
select 'ELECTRIC_DRIVE_DESCR' col_name, 'Готовность крана к телемеханизации' col_descr union all
select 'DATE_WORK_BEGIN' col_name, 'Дата ввода в эксплуатацию ТПА' col_descr union all
select 'INSTALL_TYPE_ID' col_name, 'Тип  установки' col_descr union all
select 'INVENT_NUMBER' col_name, 'Инв. номер ТПА' col_descr union all
select 'JOINT_ID' col_name, 'Тип присоединения' col_descr union all
select 'LIFETIME' col_name, 'Нормативный срок службы' col_descr union all
select 'MANUF_ID' col_name, 'Изготовитель ТПА' col_descr union all
select 'NAME_ID' col_name, 'Наименование ТПА' col_descr union all
select 'NOM_DIAM_ID' col_name, 'Номинальный диаметр DN' col_descr union all
select 'NOM_PRESS_ID' col_name, 'Номинальное давление PN' col_descr union all
select 'OPER_DATE_WORK_BEGIN' col_name, 'Год ввода в эксплуатацию привода' col_descr union all
select 'OPER_LABEL_TYPE_ID' col_name, 'Маркировка привода' col_descr union all
select 'OPER_MANUF_ID' col_name, 'Изготовитель привода' col_descr union all
select 'PASSPORT_DOCUMENT_DESCR' col_name, 'Наличие паспорта крана' col_descr union all
select 'SERIAL_NUM' col_name, 'Заводской номер' col_descr union all
select 'TECH_NUM' col_name, 'Технологический номер' col_descr union all
select 'WORK_PRESSURE_FACT' col_name, 'Фактическое рабочее давление' col_descr union all
select 'WORK_TEMP_FACT' col_name, 'Фактическая рабочая температура' col_descr union all
select 'WORK_TEMP_PROJECT' col_name, 'Проектная  рабочая температура' col_descr union all
select 'TYPE_ID' col_name, 'Тип крана' col_descr union all
select 'OPER_TYPE_ID' col_name, 'Тип привода' col_descr union all
select 'MATERIAL_ID' col_name, 'Материал изготовления корпуса' col_descr union all
select 'TPA_FIGURE_TYPE_ID' col_name, 'Маркировка ТПА по табл. фигур' col_descr union all
select 'TPA_CONSTR_TYPE_ID' col_name, 'Маркировка ТПА(по конструкт. докум.)' col_descr union all
select 'OPER_DATE_MANUF' col_name, 'Дата изготовления привода' col_descr union all
select 'OPER_SERIAL_NUMBER' col_name, 'Заводской номер привода' col_descr union all
select 'DESCR' col_name, 'Маркировка' col_descr union all
select 'DATE_EXP' col_name, 'Дата\nистеч.срока\nэксплуатации' col_descr),
valve_data as (select 'CLIMATIC_TYPE_ID' col_name, CLIMATIC_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'DATE_INSTALL' col_name, to_char(DATE_INSTALL,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER} union all
select 'DATE_MANUF' col_name, to_char(DATE_MANUF,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER} union all
select 'ELECTRIC_DRIVE_DESCR' col_name, ELECTRIC_DRIVE_DESCR::text col_descr from sutstpa.valve v where {FILTER} union all
select 'DATE_WORK_BEGIN' col_name, to_char(DATE_WORK_BEGIN,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER} union all
select 'INSTALL_TYPE_ID' col_name, INSTALL_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'INVENT_NUMBER' col_name, INVENT_NUMBER::text col_descr from sutstpa.valve v where {FILTER} union all
select 'JOINT_ID' col_name, JOINT_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'LIFETIME' col_name, LIFETIME::text col_descr from sutstpa.valve v where {FILTER} union all
select 'MANUF_ID' col_name, MANUF_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'NAME_ID' col_name, NAME_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'NOM_DIAM_ID' col_name, NOM_DIAM_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'NOM_PRESS_ID' col_name, NOM_PRESS_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_DATE_WORK_BEGIN' col_name, to_char(OPER_DATE_WORK_BEGIN,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_LABEL_TYPE_ID' col_name, OPER_LABEL_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_MANUF_ID' col_name, OPER_MANUF_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'PASSPORT_DOCUMENT_DESCR' col_name, PASSPORT_DOCUMENT_DESCR::text col_descr from sutstpa.valve v where {FILTER} union all
select 'SERIAL_NUM' col_name, SERIAL_NUM::text col_descr from sutstpa.valve v where {FILTER} union all
select 'TECH_NUM' col_name, TECH_NUM::text col_descr from sutstpa.valve v where {FILTER} union all
select 'WORK_PRESSURE_FACT' col_name, WORK_PRESSURE_FACT::text col_descr from sutstpa.valve v where {FILTER} union all
select 'WORK_TEMP_FACT' col_name, WORK_TEMP_FACT::text col_descr from sutstpa.valve v where {FILTER} union all
select 'WORK_TEMP_PROJECT' col_name, WORK_TEMP_PROJECT::text col_descr from sutstpa.valve v where {FILTER} union all
select 'TYPE_ID' col_name, TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_TYPE_ID' col_name, OPER_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'MATERIAL_ID' col_name, MATERIAL_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'TPA_FIGURE_TYPE_ID' col_name, TPA_FIGURE_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'TPA_CONSTR_TYPE_ID' col_name, TPA_CONSTR_TYPE_ID::text col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_DATE_MANUF' col_name, to_char(OPER_DATE_MANUF,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER} union all
select 'OPER_SERIAL_NUMBER' col_name, OPER_SERIAL_NUMBER::text col_descr from sutstpa.valve v where {FILTER} union all
select 'DESCR' col_name, DESCR::text col_descr from sutstpa.valve v where {FILTER} union all
select 'DATE_EXP' col_name, to_char(DATE_EXP,'DD.MM.YYYY') col_descr from sutstpa.valve v where {FILTER}),
valve as (     select v.id valve_id, spl.description||', '||spp.description||', '||round(v.station,1)||' км, Dn='||v.nom_diam_id||', '||SPN.description description from sutstpa.valve v,
     sutstpa.sprav_lpu_gcl spl, sutstpa.sprav_pipe_gcl spp, sutstpa.sprav_valve_tpa_name_gcl spn where v.lpu=spl.code and v.pipe=spp.code and spn.code=v.name_id and {FILTER})
	        SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN 
,all_in_one.ID,all_in_one.valve_id, all_in_one.column_name, all_in_one.column_value, all_in_one.col_descr, all_in_one.action_id, all_in_one.person_id,all_in_one.action_lbl, all_in_one.valve_lbl "LABEL", all_in_one.valve_lbl, all_in_one.person_lbl
  FROM (
select m.mismatch_id id /*Идентификатор - по умолчанию скрыт*/, col.col_descr column_name/*Название характеристики*/,m.column_value /*неверное начение*/, v.col_descr, /*верное значение*/
m.action_id /*Что делать*/,m.valve_id, m.person_id/*Ответственный*/, spa.description action_lbl, vv.description valve_lbl, vv.description "LABEL", p.position||', '||p.name||' '||p.last_name person_lbl from 
valve vv, sutstpa.mismatch_infoteh m, sprav_col col, valve_data v, sutstpa.sprav_service_action_gcl spa, sutstpa.notif_person p
where v.col_name=m.column_name and col.col_name=m.column_name 
 and spa.code=m.action_id and vv.valve_id=m.valve_id and p.person_id=m.person_id
 ) all_in_one) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
      </query>
     </dbQuery>
    </select>
  </data>
  <data id="SUTSTPA_NOTIF_MESSAGE" comment="NOTIF_MESSAGE" schema="SUTSTPA" table="NOTIF_MESSAGE">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <query>
	        SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN 
  ,all_in_one.ID,all_in_one.description, all_in_one.table_name, all_in_one.body, all_in_one.template_sql
  FROM (
 		SELECT message_id ID, description, table_name, body, template_sql
			FROM sutstpa.notif_message
     ) all_in_one WHERE {FILTER}) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
      </query>
     </dbQuery>
    </select>
  </data>
  <data id="SUTSTPA_NOTIF_PERSON" comment="NOTIF_PERSON" schema="SUTSTPA" table="NOTIF_PERSON">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <query>
	        SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN 
  ,all_in_one.ID,all_in_one.user_id, all_in_one.name, all_in_one.last_name, all_in_one.position, 
  all_in_one.LOGIN,all_in_one.LASTNAME,all_in_one.FIRSTNAME,all_in_one.SECONDNAME,all_in_one.MAIL
          ,all_in_one.STATUS
          ,all_in_one.CREATED
          ,all_in_one.LOGONTIME
          ,all_in_one.ACCESSTIME
  FROM (
 SELECT p.person_id ID, p.user_id, p.name, p.last_name, p.position, bup.LOGIN,bup.LASTNAME,bup.FIRSTNAME,bup.SECONDNAME,bup.MAIL
          ,CASE WHEN bup.STATUS='A' THEN 'Активен' ELSE 'Заблокирован' END STATUS
          ,TO_CHAR(bup.CREATED,'DD.MM.YYYY HH24:MI:SS') CREATED
          ,TO_CHAR(bup.LOGONTIME,'DD.MM.YYYY HH24:MI:SS') LOGONTIME
          ,TO_CHAR(bup.ACCESSTIME,'DD.MM.YYYY HH24:MI:SS') ACCESSTIME
          FROM sutstpa.notif_person p,WEB50.B_USER_PRIVATE bup
			where p.user_id=bup.user_id
				
     ) all_in_one WHERE {FILTER}) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
      </query>
     </dbQuery>
    </select>
  </data>
 <data id="SUTSTPA_SPRAV_DIAMETER_GCL" comment="SPRAV_DIAMETER_GCL" schema="SUTSTPA" table="SPRAV_DIAMETER_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_diameter_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
		  </query>
            </dbQuery>
        </select>
  </data>
 <data id="SUTSTPA_SPRAV_CLIMATIC_TYPE_ID" comment="SPRAV_CLIMATIC_TYPE_ID" schema="SUTSTPA" table="SPRAV_CLIMATIC_TYPE_ID_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_climatic_type_id_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
		  </query>
            </dbQuery>
        </select>
  </data>

<data id="SUTSTPA_SPRAV_EXECUTION_TYPE_ID_GCL" comment="SUTSTPA_SPRAV_EXECUTION_TYPE_ID_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_EXECUTION_TYPE_ID_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_execution_type_id_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_FUNC_TYPE_ID_GCL" comment="SUTSTPA_SPRAV_FUNC_TYPE_ID_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_FUNC_TYPE_ID_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_func_type_id_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_INF_COR_GCL" comment="SUTSTPA_SPRAV_INF_COR_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_INF_COR_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_inf_cor_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_INSTALL_TYPE_ID_GCL" comment="SUTSTPA_SPRAV_INSTALL_TYPE_ID_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_INSTALL_TYPE_ID_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_install_type_id_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_LES_GCL" comment="SUTSTPA_SPRAV_LES_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_LES_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_les_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_LPU_GCL" comment="SUTSTPA_SPRAV_LPU_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_LPU_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_lpu_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_MATERIAL_ID_GCL" comment="SUTSTPA_SPRAV_MATERIAL_ID_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_MATERIAL_ID_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_material_id_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_NOM_PRESSURE_GCL" comment="SUTSTPA_SPRAV_NOM_PRESSURE_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_NOM_PRESSURE_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_nom_pressure_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_NTD_GCL" comment="SUTSTPA_SPRAV_NTD_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_NTD_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, check_table, check_column, check_num, category, requirment, standard_section, standard_content, standard_name, compliance_yes, compliance_no, koeff, invert_is, unknown_message FROM 
(select s.* from sutstpa.sprav_ntd_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_OPER_LABEL_TYPE_ID_GCL" comment="SUTSTPA_SPRAV_OPER_LABEL_TYPE_ID_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_OPER_LABEL_TYPE_ID_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_oper_label_type_id_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_OPER_MANUF_ID_GCL" comment="SUTSTPA_SPRAV_OPER_MANUF_ID_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_OPER_MANUF_ID_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_oper_manuf_id_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_PIPE_GCL" comment="SUTSTPA_SPRAV_PIPE_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_PIPE_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_pipe_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_SERVICE_ACTION_GCL" comment="SUTSTPA_SPRAV_SERVICE_ACTION_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_SERVICE_ACTION_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_service_action_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_SERVICE_COND_VIOL_GCL" comment="SUTSTPA_SPRAV_SERVICE_COND_VIOL_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_SERVICE_COND_VIOL_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_service_cond_viol_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_SERVICE_EPB_GCL" comment="SUTSTPA_SPRAV_SERVICE_EPB_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_SERVICE_EPB_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_service_epb_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_SERVICE_MAINT_1_RESULT_GCL" comment="SUTSTPA_SPRAV_SERVICE_MAINT_1_RESULT_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_SERVICE_MAINT_1_RESULT_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_service_maint_1_result_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_SERVICE_MAINT_2_RESULT_GCL" comment="SUTSTPA_SPRAV_SERVICE_MAINT_2_RESULT_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_SERVICE_MAINT_2_RESULT_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_service_maint_2_result_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_SERVICE_MAINT_CORRECTION_GCL" comment="SUTSTPA_SPRAV_SERVICE_MAINT_CORRECTION_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_SERVICE_MAINT_CORRECTION_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_service_maint_correction_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_SERVICE_MAINT_GCL" comment="SUTSTPA_SPRAV_SERVICE_MAINT_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_SERVICE_MAINT_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_service_maint_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_SERVICE_REPAIR_GCL" comment="SUTSTPA_SPRAV_SERVICE_REPAIR_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_SERVICE_REPAIR_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_service_repair_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_TPA_CONSTR_TYPE_ID_GCL" comment="SUTSTPA_SPRAV_TPA_CONSTR_TYPE_ID_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_TPA_CONSTR_TYPE_ID_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_tpa_constr_type_id_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_TPA_FIGURE_TYPE_ID_GCL" comment="SUTSTPA_SPRAV_TPA_FIGURE_TYPE_ID_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_TPA_FIGURE_TYPE_ID_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_tpa_figure_type_id_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_VALVE_JOIN_GCL" comment="SUTSTPA_SPRAV_VALVE_JOIN_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_VALVE_JOIN_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_valve_join_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_VALVE_MANUF_GCL" comment="SUTSTPA_SPRAV_VALVE_MANUF_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_VALVE_MANUF_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_valve_manuf_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_VALVE_MATERIAL_TYPE_CL_GCL" comment="SUTSTPA_SPRAV_VALVE_MATERIAL_TYPE_CL_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_VALVE_MATERIAL_TYPE_CL_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_valve_material_type_cl_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_VALVE_OP_TYPE_GCL" comment="SUTSTPA_SPRAV_VALVE_OP_TYPE_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_VALVE_OP_TYPE_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_valve_op_type_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_VALVE_TPA_NAME_GCL" comment="SUTSTPA_SPRAV_VALVE_TPA_NAME_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_VALVE_TPA_NAME_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl  from sutstpa.sprav_valve_tpa_name_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_SPRAV_VALVE_TYPE_GCL" comment="SUTSTPA_SPRAV_VALVE_TYPE_GCL" schema="SUTSTPA" table="SUTSTPA_SPRAV_VALVE_TYPE_GCL">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
                   	   SELECT {COLUMNS_FILTER} FROM (
          SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS})  RWN,
		   id, code, descr,replace(replace(active_indicator_lf,'Y','1'),'N','0') active_indicator_lf, source_gcl FROM 
(select s.code id, s.code, s.description descr, s.active_indicator_lf, s.source_gcl from sutstpa.sprav_valve_type_gcl s where {FILTER}) d ) dd
          WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_MISMATCH_INF_DATA" comment="SUTSTPA_MISMATCH_INF_DATA" schema="SUTSTPA" table="MISMATCH_INF_DATA">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
with valve as (     select v.id valve_id, spl.description||', '||spp.description||', '||round(v.station,1)||' км, Dn='||v.nom_diam_id||', '||SPN.description description from sutstpa.valve v,
     sutstpa.sprav_lpu_gcl spl, sutstpa.sprav_pipe_gcl spp, sutstpa.sprav_valve_tpa_name_gcl spn where v.lpu=spl.code and v.pipe=spp.code and spn.code=v.name_id and {FILTER})
SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN 
  ,all_in_one.id, all_in_one.valve_id, all_in_one.lpu, all_in_one.pipe, all_in_one.station, all_in_one.type_id, all_in_one.oper_type_id, all_in_one.name_id, all_in_one.mest, 
all_in_one.tech_num, all_in_one.joint_id, all_in_one.nom_diam_id, all_in_one.nom_press_id, all_in_one.serial_num, all_in_one.manuf_id, all_in_one.date_manuf, 
all_in_one.valve_material_type_cl, all_in_one.install_type_id, all_in_one.tpa_constr_type_id, all_in_one.date_install, all_in_one.climatic_type_id, all_in_one.lifetime, all_in_one.oper_manuf_id, 
all_in_one.oper_date_work_begin, all_in_one.date_work_begin, all_in_one.invent_number, all_in_one.date_exp, all_in_one.prim, all_in_one.valve_lbl, all_in_one."LABEL"
  FROM (
SELECT m.inf_id id, m.valve_id, m.lpu, m.pipe, m.station, m.type_id, m.oper_type_id, m.name_id, m.mest, m.tech_num, m.joint_id, m.nom_diam_id, m.nom_press_id, m.serial_num, m.manuf_id, m.date_manuf, 
m.valve_material_type_cl, m.install_type_id, m.tpa_constr_type_id, m.date_install, m.climatic_type_id, m.lifetime, m.oper_manuf_id, m.oper_date_work_begin, m.date_work_begin, m.invent_number, m.date_exp, m.prim, vv.description valve_lbl, vv.description "LABEL"
FROM sutstpa.mismatch_inf_data m
left join valve vv on vv.valve_id=m.valve_id				
     ) all_in_one WHERE {FILTER}) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
<data id="SUTSTPA_MISMATCH_EXEC_DATA" comment="SUTSTPA_MISMATCH_EXEC_DATA" schema="SUTSTPA" table="MISMATCH_EXEC_DATA">
    <select>
            <dbQuery idField="ID">
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="LABEL"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/> 
                <query>
with valve as (     select v.id valve_id, spl.description||', '||spp.description||', '||round(v.station,1)||' км, Dn='||v.nom_diam_id||', '||SPN.description description from sutstpa.valve v,
     sutstpa.sprav_lpu_gcl spl, sutstpa.sprav_pipe_gcl spp, sutstpa.sprav_valve_tpa_name_gcl spn where v.lpu=spl.code and v.pipe=spp.code and spn.code=v.name_id and {FILTER})

SELECT {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS} ) RWN 
  ,all_in_one.id, all_in_one.valve_id, all_in_one.lpu, all_in_one.les, all_in_one.pipe, all_in_one.station, all_in_one.type_id, all_in_one.oper_type_id, all_in_one.tech_num, all_in_one.joint_id, all_in_one.nom_diam_id, 
all_in_one.nom_press_id, all_in_one.serial_num, all_in_one.manuf_id, all_in_one.date_manuf, all_in_one.valve_material_type_cl, all_in_one.install_type_id, all_in_one.tpa_figure_type_id, all_in_one.tpa_constr_type_id, 
all_in_one.date_install, all_in_one.climatic_type_id, all_in_one.lifetime, all_in_one.oper_manuf_id, all_in_one.oper_date_manuf, all_in_one.oper_label_type_id, all_in_one.oper_serial_number, all_in_one.oper_date_work_begin, all_in_one.valve_lbl, all_in_one."LABEL"
FROM (
SELECT m.id, m.valve_id, m.lpu, m.les, m.pipe, m.station, m.type_id, m.oper_type_id, m.tech_num, m.joint_id, m.nom_diam_id, m.nom_press_id, m.serial_num, m.manuf_id, m.date_manuf, m.valve_material_type_cl, m.install_type_id, m.tpa_figure_type_id, 
m.tpa_constr_type_id, m.date_install, m.climatic_type_id, m.lifetime, m.oper_manuf_id, m.oper_date_manuf, m.oper_label_type_id, m.oper_serial_number, m.oper_date_work_begin, vv.description valve_lbl, vv.description "LABEL"
FROM sutstpa.mismatch_exec_data	 m
left join valve vv on vv.valve_id=m.valve_id						
     ) all_in_one WHERE {FILTER}) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
    </query>
            </dbQuery>
        </select>
  </data>
  <data id="SUTSTPA_SERVICE_MAINTENANCE_VALVE" comment="SERVICE_MAINTENANCE" schema="SUTSTPA" table="SERVICE_MAINTENANCE">
    <select>
     <dbQuery>
       <var name="FILTER" default="1=1"/>
       <var name="ORDER_COLUMNS" default="ID"/>
       <var name="LOW_LIMIT" default="1"/>
       <var name="HIGH_LIMIT" default="65536"/>
       <var name="COLUMNS_FILTER" default="*"/>
       <query>
	   with year_list as (
select 2021 year_num union all
select 2022 year_num union all
select 2023 year_num union all
select 2024 year_num union all
select 2025 year_num),
valve as (     select v.id valve_id, spl.description||', '||spp.description||', '||round(v.station,1)||' км, Dn='||v.nom_diam_id||', '||SPN.description description from sutstpa.valve v,
     sutstpa.sprav_lpu_gcl spl, sutstpa.sprav_pipe_gcl spp, sutstpa.sprav_valve_tpa_name_gcl spn where v.lpu=spl.code and v.pipe=spp.code and spn.code=v.name_id 
     and exists (select 1 from sutstpa.service_maintenance m where m.valve_id=v.id)
     and {FILTER})
     select {COLUMNS_FILTER} FROM (
     SELECT ROW_NUMBER() OVER (ORDER BY {ORDER_COLUMNS}) RWN 
  ,all_in_one.ID,all_in_one.valve_id,
  all_in_one.date_plan_01,all_in_one.date_fact_01, all_in_one.date_plan_02,all_in_one.date_fact_02, all_in_one.date_plan_03,all_in_one.date_fact_03, all_in_one.date_plan_04,all_in_one.date_fact_04,
  all_in_one.date_plan_05,all_in_one.date_fact_05, all_in_one.date_plan_06,all_in_one.date_fact_06, all_in_one.date_plan_07,all_in_one.date_fact_07, all_in_one.date_plan_08,all_in_one.date_fact_08,
  all_in_one.date_plan_09,all_in_one.date_fact_09, all_in_one.date_plan_10,all_in_one.date_fact_10, all_in_one.date_plan_11,all_in_one.date_fact_11, all_in_one.date_plan_12,all_in_one.date_fact_12,
  all_in_one.result_01, all_in_one.result_02, all_in_one.result_03, all_in_one.result_04, all_in_one.result_05, all_in_one.result_06, all_in_one.result_07, all_in_one.result_08, all_in_one.result_09, 
  all_in_one.result_10, all_in_one.result_11, all_in_one.result_12, all_in_one.seal_past_cons_plan, all_in_one.seal_past_cons_fact, all_in_one.hydrofluid_cons_plan, all_in_one.hydrofluid_cons_fact, 
  all_in_one.valve_lbl, all_in_one."LABEL",all_in_one.year_num
  FROM (
 SELECT v.valve_id id,v.valve_id,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.01.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_01,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.02.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_02,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.03.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_03,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.04.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_04,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.05.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_05,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.06.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_06,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.07.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_07,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.08.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_08,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.09.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_09,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.10.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_10,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.11.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_11,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'DD.MM.YYYY') like '%.12.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_12,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.01.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_01,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.02.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_02,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.03.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_03,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.04.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_04,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.05.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_05,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.06.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_06,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.07.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_07,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.08.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_08,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.09.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_09,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.10.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_10,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.11.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_11,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.12.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_12,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.01.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_01,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.02.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_02,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.03.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_03,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.04.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_04,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.05.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_05,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.06.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_06,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.07.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_07,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.08.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_08,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.09.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_09,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.10.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_10,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.11.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_11,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_fact,'DD.MM.YYYY') like '%.12.%' and vv.type_cl='ТО1' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_12,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'MM')::numeric&lt;=6 and vv.type_cl='ТО2' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_half_1,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'MM')::numeric&lt;=6 and vv.type_cl='ТО2' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_half_1,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_plan,'MM')::numeric&lt;=6 and vv.type_cl='ТО2' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_half_1,
(select vv.date_fact from sutstpa.service_maintenance vv where to_char(vv.date_fact,'MM')::numeric&gt;6 and vv.type_cl='ТО2' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) date_fact_half_2,
(select vv.date_plan from sutstpa.service_maintenance vv where to_char(vv.date_plan,'MM')::numeric&gt;6 and vv.type_cl='ТО2' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_plan desc limit 1) date_plan_half_2,
(select vv.result from sutstpa.service_maintenance vv where to_char(vv.date_plan,'MM')::numeric&gt;6 and vv.type_cl='ТО2' and vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric order by vv.date_fact desc limit 1) result_half_2,
 (select vv.seal_past_cons_plan from sutstpa.valve vv where vv.id=v.valve_id) seal_past_cons_plan, 
 (select sum(vv.lubricant_value_fact) from sutstpa.service_maintenance vv where vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric) seal_past_cons_fact, 
 (select vv.hydrofluid_cons_plan from sutstpa.valve vv where vv.id=v.valve_id) 	hydrofluid_cons_plan, 
 (select sum(vv.hydrofluid_value_fact) from sutstpa.service_maintenance vv where vv.valve_id=v.valve_id and y.year_num=to_char(vv.date_plan,'YYYY')::numeric) hydrofluid_cons_fact, 
 v.description valve_lbl, 
 v.description "LABEL",
 y.year_num	FROM valve v, year_list y where y.year_num in (select to_char(m.date_plan,'YYYY')::numeric from sutstpa.service_maintenance m where m.valve_id=v.valve_id)
     ) all_in_one) sorted
     WHERE RWN BETWEEN {LOW_LIMIT}  AND {HIGH_LIMIT}
      </query>
     </dbQuery>
    </select>
  </data>
</root>